# BackupStorageLocation using local-volume-provider for NFS storage
#
# This BSL is created separately from the DPA because OADP doesn't validate
# custom providers (replicated.com/nfs) during DPA reconciliation.
# The custom plugin is loaded when Velero deploys, enabling this BSL to work.
apiVersion: velero.io/v1
kind: BackupStorageLocation
metadata:
  name: velero-nfs
  namespace: openshift-adp
  annotations:
    argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
spec:
  provider: replicated.com/nfs
  default: true
  objectStorage:
    # For local-volume-provider, bucket creates a subdirectory structure
    # on the NFS share for storing backup data and Kopia repositories
    # Result: /storage-mass/ocp-home/velero/backups
    bucket: backups
  config:
    path: /storage-mass/ocp-home/velero
    server: qnap-01.rh-lab.morey.tech
